# 活动演示

### 示例

import ActivityExample from "@site/src/example/business/activity/base";

<ActivityExample />

```tsx
export enum ActivityStatus {
  Pending = 1,
  Voting = 2,
  PreMatch = 3,
  Matching = 4,
  Publicizing = 5,
  Ended = 6,
}

export const ActivityStatusMap: Record<ActivityStatus, string> = {
  [ActivityStatus.Pending]: "待开始",
  [ActivityStatus.Voting]: "投票中",
  [ActivityStatus.PreMatch]: "赛前",
  [ActivityStatus.Matching]: "比赛中",
  [ActivityStatus.Publicizing]: "公示中",
  [ActivityStatus.Ended]: "已结束",
};

// 解析后的活动时间配置（matchEnd 使用布尔表示比赛是否结束）
export type ActivityResolved = {
  start: Date;
  voteEnd: Date;
  matchStart: Date;
  matchEnd: boolean;
  end: Date;
};

// 按生命周期计算当前状态
export function getStatus(now: Date, t: ActivityResolved): ActivityStatus {
  if (now < t.start) return ActivityStatus.Pending;
  if (now >= t.start && now < t.voteEnd) return ActivityStatus.Voting;
  if (now >= t.voteEnd && now < t.matchStart) return ActivityStatus.PreMatch;
  if (now >= t.matchStart && now < t.end)
    return t.matchEnd ? ActivityStatus.Publicizing : ActivityStatus.Matching;
  return ActivityStatus.Ended;
}

export const canVote = useMemo(() => {
  // 投票只能发生在投票窗口内
  if (status === ActivityStatus.Voting) {
    return true;
  }
}, [status]);

export const canAdvance = useMemo(() => {
  // 晋级只能发生在比赛之后的公式窗口期内
  if (status === ActivityStatus.Publicizing) {
    return true;
  }
}, [status, voted]);

export const canClaimReward = useMemo(() => {
  // 领奖只能发生在公示窗口期，并且需要用户投过票，且所投票的队伍已晋级
  if (voted && advanced && status === ActivityStatus.Publicizing) {
    return true;
  }
}, [status, voted, advanced]);
```
